<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåª –ú–æ—è –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ –Ü–¥–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #fafafa 0%, #ffffff 100%);
            min-height: 100vh;
            color: #2c2c2c;
            line-height: 1.6;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding: 20px;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 300px;
            height: 100vh;
            background-image: url('mui.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            z-index: 0;
            opacity: 0.8;
        }

        body::after {
            content: '';
            position: fixed;
            top: 0;
            right: 0;
            width: 300px;
            height: 100vh;
            background-image: url('mui.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            z-index: 0;
            opacity: 0.8;
            transform: scaleX(-1);
        }

        .container {
            max-width: 1000px;
            width: 100%;
            padding: 40px;
            position: relative;
            z-index: 1;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px) saturate(180%);
            min-height: calc(100vh - 40px);
            box-shadow: 
                0 8px 32px rgba(139, 0, 0, 0.1),
                0 0 0 1px rgba(255, 255, 255, 0.2);
            border-radius: 24px;
        }

        .header {
            text-align: center;
            margin-bottom: 48px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(248, 248, 248, 0.9) 100%);
            padding: 48px 40px;
            border-radius: 24px;
            box-shadow: 
                0 4px 24px rgba(139, 0, 0, 0.08),
                0 0 0 1px rgba(139, 0, 0, 0.1);
            position: relative;
            backdrop-filter: blur(10px);
        }

        .header h1 {
            color: #2c2c2c;
            font-size: 3.2em;
            font-weight: 800;
            margin-bottom: 16px;
            letter-spacing: -0.02em;
            background: linear-gradient(135deg, #2c2c2c 0%, #8B0000 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header p {
            color: #666;
            font-size: 1.3em;
            font-weight: 500;
        }

        .section {
            background: rgba(255, 255, 255, 0.8);
            padding: 32px;
            border-radius: 20px;
            margin-bottom: 24px;
            box-shadow: 
                0 4px 24px rgba(0, 0, 0, 0.04),
                0 0 0 1px rgba(139, 0, 0, 0.08);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent 0%, #8B0000 50%, transparent 100%);
            border-radius: 20px 20px 0 0;
        }

        .section:hover {
            transform: translateY(-4px);
            box-shadow: 
                0 8px 40px rgba(139, 0, 0, 0.12),
                0 0 0 1px rgba(139, 0, 0, 0.15);
        }

        .section h2 {
            color: #2c2c2c;
            font-size: 2em;
            font-weight: 700;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .daily-wisdom {
            background: linear-gradient(135deg, rgba(139, 0, 0, 0.9) 0%, rgba(44, 44, 44, 0.9) 100%);
            color: white;
            padding: 32px;
            border-radius: 20px;
            text-align: center;
            font-size: 1.3em;
            font-weight: 500;
            margin-bottom: 32px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 8px 32px rgba(139, 0, 0, 0.2),
                0 0 0 1px rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }

        .daily-wisdom:hover {
            transform: translateY(-2px) scale(1.01);
            box-shadow: 
                0 12px 40px rgba(139, 0, 0, 0.25),
                0 0 0 1px rgba(255, 255, 255, 0.2);
        }

        .story-textarea {
            width: 100%;
            min-height: 120px;
            padding: 20px;
            border: 2px solid rgba(139, 0, 0, 0.1);
            border-radius: 16px;
            font-size: 1.1em;
            font-family: inherit;
            background: rgba(255, 255, 255, 0.8);
            color: #2c2c2c;
            transition: all 0.3s ease;
            resize: vertical;
            backdrop-filter: blur(10px);
        }

        .story-textarea:focus {
            outline: none;
            border-color: rgba(139, 0, 0, 0.3);
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 0 0 4px rgba(139, 0, 0, 0.05);
        }

        .btn {
            background: linear-gradient(135deg, rgba(139, 0, 0, 0.9) 0%, rgba(160, 0, 0, 0.9) 100%);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 16px 32px;
            border-radius: 16px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            margin-top: 20px;
            position: relative;
            text-transform: none;
            letter-spacing: 0.5px;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 16px rgba(139, 0, 0, 0.2);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(139, 0, 0, 0.3);
            background: linear-gradient(135deg, rgba(160, 0, 0, 0.9) 0%, rgba(139, 0, 0, 0.9) 100%);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn.loading::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            border: 2px solid transparent;
            border-top: 2px solid white;
            border-radius: 50%;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: translateY(-50%) rotate(360deg); }
        }

        .reflection {
            background: linear-gradient(135deg, rgba(248, 248, 248, 0.9) 0%, rgba(255, 255, 255, 0.9) 100%);
            padding: 28px;
            border-radius: 16px;
            margin-top: 24px;
            border-left: 3px solid rgba(139, 0, 0, 0.3);
            border: 1px solid rgba(139, 0, 0, 0.1);
            display: none;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.04);
        }

        .reflection-text {
            font-size: 1.1em;
            line-height: 1.7;
            color: #2c2c2c;
            font-weight: 400;
        }

        .cultural-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 28px;
        }

        .cultural-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(248, 248, 248, 0.9) 100%);
            padding: 28px;
            border-radius: 16px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid rgba(139, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.04);
        }

        .cultural-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, transparent 0%, rgba(139, 0, 0, 0.6) 50%, transparent 100%);
        }

        .cultural-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 12px 32px rgba(139, 0, 0, 0.15);
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(250, 250, 250, 0.95) 100%);
            border-color: rgba(139, 0, 0, 0.2);
        }

        .cultural-card h3 {
            color: #2c2c2c;
            font-size: 1.4em;
            font-weight: 700;
            margin-bottom: 12px;
        }

        .cultural-card p {
            color: #666;
            font-size: 1em;
            line-height: 1.5;
            font-weight: 400;
        }

        .category-options {
            margin-top: 28px;
            padding: 28px;
            background: linear-gradient(135deg, rgba(248, 248, 248, 0.9) 0%, rgba(255, 255, 255, 0.9) 100%);
            border-radius: 16px;
            border: 1px solid rgba(139, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.04);
        }

        .category-options h3 {
            color: #2c2c2c;
            font-size: 1.5em;
            font-weight: 700;
            margin-bottom: 24px;
            text-align: center;
        }

        .subcategory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }

        .subcategory-card {
            background: rgba(255, 255, 255, 0.8);
            padding: 18px;
            border-radius: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid rgba(139, 0, 0, 0.1);
            font-weight: 500;
            color: #2c2c2c;
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
        }

        .subcategory-card:hover {
            background: linear-gradient(135deg, rgba(139, 0, 0, 0.9) 0%, rgba(160, 0, 0, 0.9) 100%);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(139, 0, 0, 0.2);
        }

        .lesson-content {
            display: none;
            background: linear-gradient(135deg, rgba(240, 240, 240, 0.9) 0%, rgba(248, 248, 248, 0.9) 100%);
            padding: 28px;
            border-radius: 16px;
            margin-top: 24px;
            border-left: 3px solid rgba(44, 44, 44, 0.3);
            border: 1px solid rgba(44, 44, 44, 0.1);
            color: #2c2c2c;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.04);
        }

        .chat-section {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(248, 248, 248, 0.9) 100%);
            padding: 32px;
            border-radius: 20px;
            margin-bottom: 24px;
            box-shadow: 
                0 4px 24px rgba(44, 44, 44, 0.08),
                0 0 0 1px rgba(44, 44, 44, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .chat-input {
            display: flex;
            gap: 16px;
            margin-top: 24px;
        }

        .chat-input input {
            flex: 1;
            padding: 16px 20px;
            border: 2px solid rgba(139, 0, 0, 0.1);
            border-radius: 16px;
            font-size: 1.1em;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.8);
            color: #2c2c2c;
            font-weight: 400;
            backdrop-filter: blur(10px);
        }

        .chat-input input:focus {
            outline: none;
            border-color: rgba(139, 0, 0, 0.3);
            box-shadow: 0 0 0 4px rgba(139, 0, 0, 0.05);
            background: rgba(255, 255, 255, 0.95);
        }

        .chat-btn {
            background: linear-gradient(135deg, rgba(44, 44, 44, 0.9) 0%, rgba(26, 26, 26, 0.9) 100%);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 16px 28px;
            border-radius: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-transform: none;
            letter-spacing: 0.5px;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 16px rgba(44, 44, 44, 0.2);
        }

        .chat-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(44, 44, 44, 0.3);
        }

        .chat-response {
            background: linear-gradient(135deg, rgba(245, 245, 245, 0.9) 0%, rgba(248, 248, 248, 0.9) 100%);
            padding: 24px;
            border-radius: 16px;
            margin-top: 20px;
            border-left: 3px solid rgba(44, 44, 44, 0.3);
            border: 1px solid rgba(44, 44, 44, 0.1);
            display: none;
            color: #2c2c2c;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.04);
        }

        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 28px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(248, 248, 248, 0.9) 100%);
            border-radius: 16px;
            color: #666;
            border: 1px solid rgba(139, 0, 0, 0.1);
            font-weight: 500;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.04);
        }

        .error {
            background: linear-gradient(135deg, rgba(255, 245, 245, 0.9) 0%, rgba(255, 248, 248, 0.9) 100%);
            color: #8B0000;
            padding: 20px;
            border-radius: 12px;
            margin-top: 20px;
            border-left: 3px solid rgba(139, 0, 0, 0.3);
            border: 1px solid rgba(255, 204, 204, 0.3);
            font-weight: 500;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 16px rgba(139, 0, 0, 0.08);
        }

        /* Mobile Design */
        @media (max-width: 1600px) {
            body::before,
            body::after {
                width: 200px;
            }
            
            .container {
                max-width: 900px;
            }
        }
        
        @media (max-width: 1400px) {
            body::before,
            body::after {
                width: 150px;
            }
            
            .container {
                max-width: 800px;
            }
        }
        
        @media (max-width: 1200px) {
            body::before,
            body::after {
                display: none;
            }
            
            body {
                padding: 20px;
            }
            
            .container {
                max-width: 100%;
                background: rgba(255, 255, 255, 0.95);
                box-shadow: 0 8px 32px rgba(139, 0, 0, 0.1);
            }
        }
        
        @media (max-width: 768px) {
            body {
                padding: 16px;
            }
            
            .container {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2.4em;
            }
            
            .section {
                padding: 24px;
            }
            
            .cultural-grid {
                grid-template-columns: 1fr;
            }

            .chat-input {
                flex-direction: column;
            }

            .subcategory-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }

        /* Focus states */
        *:focus {
            outline: 2px solid rgba(139, 0, 0, 0.3);
            outline-offset: 2px;
        }

        /* Glassmorphism enhancements */
        @supports (backdrop-filter: blur(20px)) {
            .container {
                background: rgba(255, 255, 255, 0.85);
                backdrop-filter: blur(20px) saturate(180%);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü´Ç –ú–æ—è –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ –Ü–¥–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å</h1>
            <p>–¶–∏—Ñ—Ä–æ–≤–µ —Å–µ—Ä—Ü–µ, —â–æ –≥–æ–≤–æ—Ä–∏—Ç—å —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é –¥—É—à–µ—é</p>
        </div>

        <div class="daily-wisdom" id="dailyWisdom" onclick="loadDailyWisdom()">
            –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º—É–¥—Ä–æ—Å—Ç—ñ –¥–Ω—è...
        </div>

        <div class="main-content">
            <!-- Identity Builder Section -->
            <div class="section story-input">
                <h2>ü´Ä –†–æ–∑–∫–∞–∂—ñ—Ç—å –ø—Ä–æ —Å–µ–±–µ</h2>
                <p>–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—î—é —ñ—Å—Ç–æ—Ä—ñ—î—é - —ñ–º'—è–º, —Ä–æ–¥–∏–Ω–æ—é, —Å–ø–æ–≥–∞–¥–∞–º–∏, –º—ñ—Å—Ü–µ–º –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è. –Ø –≤—ñ–¥—á—É—é –≤–∞—à—É —É–∫—Ä–∞—ó–Ω—Å—å–∫—É –¥—É—à—É.</p>
                <textarea 
                    class="story-textarea" 
                    id="userStory"
                    placeholder="–ú–µ–Ω–µ –∑–≤–∞—Ç–∏... –Ø –Ω–∞—Ä–æ–¥–∏–≤—Å—è/–Ω–∞—Ä–æ–¥–∏–ª–∞—Å—è... –ú–æ—è —Ä–æ–¥–∏–Ω–∞... –ú–æ—ó —Å–ø–æ–≥–∞–¥–∏ –ø—Ä–æ –£–∫—Ä–∞—ó–Ω—É..."
                ></textarea>
                <button class="btn" id="reflectBtn" onclick="generateReflection()">‚ú® –í—ñ–¥–æ–±—Ä–∞–∑–∏—Ç–∏ –º–æ—é —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å</button>
                
                <div class="reflection" id="reflectionBox">
                    <div class="reflection-text" id="reflectionText"></div>
                </div>
            </div>

            <!-- Cultural Learning Section -->
            <div class="section">
                <h2>üß† –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ —ñ–Ω—Ç–µ–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞ —Å–ø–∞–¥—â–∏–Ω–∞</h2>
                <p>–ì–ª–∏–±–æ–∫–µ –ø—ñ–∑–Ω–∞–Ω–Ω—è —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—ó –¥—É–º–∫–∏, —Ñ—ñ–ª–æ—Å–æ—Ñ—ñ—ó —Ç–∞ —ñ–Ω—Ç–µ–ª–µ–∫—Ç—É–∞–ª—å–Ω–∏—Ö –¥–æ—Å—è–≥–Ω–µ–Ω—å</p>
                
                <div class="cultural-grid">
                    <div class="cultural-card" onclick="showCategoryOptions('language')">
                        <h3>üó£Ô∏è –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ –º–æ–≤–∞</h3>
                        <p>–ì–ª–∏–±–∏–Ω–Ω—ñ –∞—Å–ø–µ–∫—Ç–∏ –º–æ–≤–∏ —Ç–∞ –º–æ–≤–æ–∑–Ω–∞–≤—Å—Ç–≤–∞</p>
                    </div>
                    <div class="cultural-card" onclick="showCategoryOptions('history')">
                        <h3>üìú –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ —ñ—Å—Ç–æ—Ä—ñ—è</h3>
                        <p>–ö–ª—é—á–æ–≤—ñ –ø–æ–¥—ñ—ó —Ç–∞ –ø–æ—Å—Ç–∞—Ç—ñ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—ó —ñ—Å—Ç–æ—Ä—ñ—ó</p>
                    </div>
                    <div class="cultural-card" onclick="showCategoryOptions('ethnography')">
                        <h3>üåæ –ï—Ç–Ω–æ–≥—Ä–∞—Ñ—ñ—è —Ç–∞ —Ñ–æ–ª—å–∫–ª–æ—Ä</h3>
                        <p>–¢—Ä–∞–¥–∏—Ü—ñ—ó, –æ–±—Ä—è–¥–∏ —Ç–∞ –Ω–∞—Ä–æ–¥–Ω–∞ –∫—É–ª—å—Ç—É—Ä–∞</p>
                    </div>
                    <div class="cultural-card" onclick="showCategoryOptions('literature')">
                        <h3>üìñ –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞</h3>
                        <p>–ì–ª–∏–±–æ–∫–∏–π –∞–Ω–∞–ª—ñ–∑ –∫–ª–∞—Å–∏–∫—ñ–≤ —Ç–∞ —Å—É—á–∞—Å–Ω–∏–∫—ñ–≤</p>
                    </div>
                    <div class="cultural-card" onclick="showCategoryOptions('freedom')">
                        <h3>‚öîÔ∏è –ë–æ—Ä–æ—Ç—å–±–∞ –∑–∞ —Å–≤–æ–±–æ–¥—É</h3>
                        <p>–Ø–∫ —É–∫—Ä–∞—ó–Ω—Ü—ñ –±–æ—Ä–æ–ª–∏—Å—è –∑–∞ –Ω–µ–∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å</p>
                    </div>
                    <div class="cultural-card" onclick="showCategoryOptions('content')">
                        <h3>üéµ –£–∫—Ä–∞—ó–Ω—Å—å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç</h3>
                        <p>–ü—ñ—Å–Ω—ñ, –∫–Ω–∏–≥–∏ —Ç–∞ –∫—É–ª—å—Ç—É—Ä–Ω—ñ —Ç–≤–æ—Ä–∏</p>
                    </div>
                </div>
                
                <!-- Category Options -->
                <div class="category-options" id="categoryOptions" style="display: none;">
                    <h3 id="categoryTitle"></h3>
                    <div class="subcategory-grid" id="subcategoryGrid"></div>
                </div>
                
                <div class="lesson-content" id="lessonContent"></div>
            </div>

            <!-- AI Chat Section -->
            <div class="section chat-section">
                <h2>ü§ù –ü–æ–≥–æ–≤–æ—Ä–∏–º–æ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é</h2>
                <p>–ü–æ—Å—Ç–∞–≤—Ç–µ –±—É–¥—å-—è–∫–µ –ø–∏—Ç–∞–Ω–Ω—è –ø—Ä–æ –£–∫—Ä–∞—ó–Ω—É, –∫—É–ª—å—Ç—É—Ä—É, –º–æ–≤—É –∞–±–æ –ø—Ä–æ—Å—Ç–æ –ø–æ–≥–æ–≤–æ—Ä–∏–º–æ!</p>
                
                <div class="chat-input">
                    <input type="text" id="chatInput" placeholder="–ù–∞–ø–∏—à—ñ—Ç—å –≤–∞—à–µ –ø–∏—Ç–∞–Ω–Ω—è —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é..." onkeypress="handleChatKeyPress(event)">
                    <button class="chat-btn" id="chatBtn" onclick="sendMessage()">–ù–∞–¥—ñ—Å–ª–∞—Ç–∏</button>
                </div>
                
                <div class="chat-response" id="chatResponse">
                    <div id="chatText"></div>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>üíõüíô –ó—Ä–æ–±–ª–µ–Ω–æ –∑ –ª—é–±–æ–≤'—é –¥–æ –£–∫—Ä–∞—ó–Ω–∏ —Ç–∞ —ó—ó –Ω–∞—Ä–æ–¥—É üíôüíõ</p>
            <p style="font-size: 0.9em; margin-top: 10px;">–ü—Ä–∞—Ü—é—î –Ω–∞ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó —à—Ç—É—á–Ω–æ–≥–æ —ñ–Ω—Ç–µ–ª–µ–∫—Ç—É Anthropic Claude</p>
        </div>
    </div>

    <script>
        let isLoading = false;

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            loadDailyWisdom();
        });

        // Load daily wisdom from API
        async function loadDailyWisdom() {
            try {
                const response = await fetch('/api/daily-wisdom');
                if (response.ok) {
                    const data = await response.json();
                    document.getElementById('dailyWisdom').textContent = data.wisdom;
                } else {
                    throw new Error('Failed to load wisdom');
                }
            } catch (error) {
                console.error('Error loading daily wisdom:', error);
                document.getElementById('dailyWisdom').textContent = '–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å, —â–æ–± –æ–Ω–æ–≤–∏—Ç–∏ –º—É–¥—Ä—ñ—Å—Ç—å –¥–Ω—è';
            }
        }

        // Generate AI reflection
        async function generateReflection() {
            const story = document.getElementById('userStory').value.trim();
            const reflectionBox = document.getElementById('reflectionBox');
            const reflectionText = document.getElementById('reflectionText');
            const reflectBtn = document.getElementById('reflectBtn');
            
            if (!story) {
                showError('–ë—É–¥—å –ª–∞—Å–∫–∞, —Ä–æ–∑–∫–∞–∂—ñ—Ç—å —â–æ—Å—å –ø—Ä–æ —Å–µ–±–µ');
                return;
            }

            if (isLoading) return;
            
            isLoading = true;
            reflectBtn.disabled = true;
            reflectBtn.textContent = '–û–±—Ä–æ–±–∫–∞...';
            
            try {
                const response = await fetch('/api/reflect', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ story: story })
                });

                const data = await response.json();
                
                if (response.ok && data.success) {
                    reflectionText.innerHTML = data.reflection;
                    reflectionBox.style.display = 'block';
                    reflectionBox.scrollIntoView({ behavior: 'smooth' });
                } else {
                    throw new Error(data.error || 'Failed to generate reflection');
                }
            } catch (error) {
                showError('–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è: ' + error.message);
            } finally {
                isLoading = false;
                reflectBtn.disabled = false;
                reflectBtn.textContent = '‚ú® –í—ñ–¥–æ–±—Ä–∞–∑–∏—Ç–∏ –º–æ—é —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å';
            }
        }

        // Show lesson
        async function showLesson(type) {
            const lessonContent = document.getElementById('lessonContent');
            
            if (isLoading) return;
            
            isLoading = true;
            lessonContent.innerHTML = '<div style="text-align: center; padding: 20px;">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —É—Ä–æ–∫—É...</div>';
            lessonContent.style.display = 'block';
            
            try {
                const response = await fetch('/api/lesson', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ 
                        type: type, 
                        level: '–ø–æ—á–∞—Ç–∫–æ–≤–∏–π' 
                    })
                });

                const data = await response.json();
                
                if (response.ok && data.success) {
                    lessonContent.innerHTML = `<div class="reflection-text">${data.lesson}</div>`;
                    lessonContent.scrollIntoView({ behavior: 'smooth' });
                } else {
                    throw new Error(data.error || 'Failed to load lesson');
                }
            } catch (error) {
                lessonContent.innerHTML = `<div class="error">–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —É—Ä–æ–∫—É: ${error.message}</div>`;
            } finally {
                isLoading = false;
            }
        }

        // Show category options
        function showCategoryOptions(category) {
            const categoryOptions = document.getElementById('categoryOptions');
            const categoryTitle = document.getElementById('categoryTitle');
            const subcategoryGrid = document.getElementById('subcategoryGrid');
            
            const categories = {
                'language': {
                    title: 'üó£Ô∏è –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ –º–æ–≤–∞',
                    subcategories: [
                        { name: '–ï—Ç–∏–º–æ–ª–æ–≥—ñ—è —Ç–∞ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è', id: 'etymology' },
                        { name: '–î—ñ–∞–ª–µ–∫—Ç–∏ —Ç–∞ –≥–æ–≤—ñ—Ä–∫–∏', id: 'dialects' },
                        { name: '–ú–æ–≤–∞ —è–∫ –∫–æ–¥ –∫—É–ª—å—Ç—É—Ä–∏', id: 'language_culture_code' },
                        { name: '–ù–µ–æ–ª–æ–≥—ñ–∑–º–∏ —Ç–∞ –∞—Ä—Ö–∞—ó–∑–º–∏', id: 'neologisms_archaisms' },
                        { name: '–ü—Å–∏—Ö–æ–ª—ñ–Ω–≥–≤—ñ—Å—Ç–∏–∫–∞', id: 'psycholinguistics' },
                        { name: '–í–∏–ø–∞–¥–∫–æ–≤–∞ —Ç–µ–º–∞', id: 'linguistics_random' }
                    ]
                },
                'history': {
                    title: 'üìú –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ —ñ—Å—Ç–æ—Ä—ñ—è',
                    subcategories: [
                        { name: '–ö–∏—ó–≤—Å—å–∫–∞ –†—É—Å—å —Ç–∞ —Å–ø–∞–¥—â–∏–Ω–∞', id: 'kyivan_rus' },
                        { name: '–ö–æ–∑–∞—Ü—å–∫–∞ –¥–µ—Ä–∂–∞–≤–∞ –•–º–µ–ª—å–Ω–∏—Ü—å–∫–æ–≥–æ', id: 'cossack_state' },
                        { name: '–ì–∞–ª–∏—Ü—å–∫–æ-–í–æ–ª–∏–Ω—Å—å–∫–µ –∫–Ω—è–∑—ñ–≤—Å—Ç–≤–æ', id: 'galicia_volhynia' },
                        { name: '–£–ù–† —Ç–∞ –≤–∏–∑–≤–æ–ª—å–Ω—ñ –∑–º–∞–≥–∞–Ω–Ω—è', id: 'unr_liberation' },
                        { name: '–ì–æ–ª–æ–¥–æ–º–æ—Ä —Ç–∞ —Ä–µ–ø—Ä–µ—Å—ñ—ó', id: 'holodomor_repressions' },
                        { name: '–í–∏–ø–∞–¥–∫–æ–≤–∞ —Ç–µ–º–∞', id: 'history_random' }
                    ]
                },
                'ethnography': {
                    title: 'üåæ –ï—Ç–Ω–æ–≥—Ä–∞—Ñ—ñ—è —Ç–∞ —Ñ–æ–ª—å–∫–ª–æ—Ä',
                    subcategories: [
                        { name: '–ö–∞–ª–µ–Ω–¥–∞—Ä–Ω—ñ –æ–±—Ä—è–¥–∏ —Ç–∞ —Å–≤—è—Ç–∞', id: 'calendar_rituals' },
                        { name: '–ù–∞—Ä–æ–¥–Ω—ñ –≤—ñ—Ä—É–≤–∞–Ω–Ω—è —Ç–∞ –º—ñ—Ñ–æ–ª–æ–≥—ñ—è', id: 'folk_beliefs' },
                        { name: '–¢—Ä–∞–¥–∏—Ü—ñ–π–Ω–µ –≥–æ—Å–ø–æ–¥–∞—Ä—Å—Ç–≤–æ', id: 'traditional_economy' },
                        { name: '–†–æ–¥–∏–Ω–Ω–æ-–ø–æ–±—É—Ç–æ–≤—ñ —Ç—Ä–∞–¥–∏—Ü—ñ—ó', id: 'family_traditions' },
                        { name: '–£—Å–Ω–∞ –Ω–∞—Ä–æ–¥–Ω–∞ —Ç–≤–æ—Ä—á—ñ—Å—Ç—å', id: 'oral_folklore' },
                        { name: '–í–∏–ø–∞–¥–∫–æ–≤–∞ —Ç–µ–º–∞', id: 'ethnography_random' }
                    ]
                },
                'literature': {
                    title: 'üìñ –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞',
                    subcategories: [
                        { name: '–†–æ–º–∞–Ω—Ç–∏–∑–º —Ç–∞ –®–µ–≤—á–µ–Ω–∫–æ', id: 'romanticism_shevchenko' },
                        { name: '–†–µ–∞–ª—ñ–∑–º –∫—ñ–Ω—Ü—è XIX —Å—Ç.', id: 'realism_19th' },
                        { name: '–ú–æ–¥–µ—Ä–Ω—ñ–∑–º 1920-—Ö —Ä–æ–∫—ñ–≤', id: 'modernism_1920s' },
                        { name: '–®—ñ—Å—Ç–¥–µ—Å—è—Ç–Ω–∏–∫–∏ —Ç–∞ –¥–∏—Å–∏–¥–µ–Ω—Ç—Å—Ç–≤–æ', id: 'sixtiers_dissidents' },
                        { name: '–°—É—á–∞—Å–Ω–∞ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞ (1991-)', id: 'contemporary_literature' },
                        { name: '–í–∏–ø–∞–¥–∫–æ–≤–∞ —Ç–µ–º–∞', id: 'literature_random' }
                    ]
                },
                'freedom': {
                    title: '‚öîÔ∏è –ë–æ—Ä–æ—Ç—å–±–∞ –∑–∞ —Å–≤–æ–±–æ–¥—É',
                    subcategories: [
                        { name: '–ö–æ–∑–∞—Ü—å–∫—ñ –ø–æ–≤—Å—Ç–∞–Ω–Ω—è XVI-XVIII —Å—Ç.', id: 'cossack_uprisings' },
                        { name: '–í–∏–∑–≤–æ–ª—å–Ω—ñ –∑–º–∞–≥–∞–Ω–Ω—è 1917-1921', id: 'liberation_1917_1921' },
                        { name: '–û–£–ù-–£–ü–ê —Ç–∞ –Ω–∞—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ-–≤–∏–∑–≤–æ–ª—å–Ω–∞ –±–æ—Ä–æ—Ç—å–±–∞', id: 'oun_upa' },
                        { name: '–î–∏—Å–∏–¥–µ–Ω—Ç—Å—å–∫–∏–π —Ä—É—Ö —Ç–∞ –ø—Ä–∞–≤–æ–∑–∞—Ö–∏—Å–Ω–∏–∫–∏', id: 'dissident_movement' },
                        { name: '–†–µ–≤–æ–ª—é—Ü—ñ—è –ì—ñ–¥–Ω–æ—Å—Ç—ñ —Ç–∞ —Å—É—á–∞—Å–Ω–∞ –±–æ—Ä–æ—Ç—å–±–∞', id: 'revolution_dignity' },
                        { name: '–í–∏–ø–∞–¥–∫–æ–≤–∞ —Ç–µ–º–∞', id: 'freedom_random' }
                    ]
                },
                'content': {
                    title: 'üéµ –£–∫—Ä–∞—ó–Ω—Å—å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç',
                    subcategories: [
                        { name: '–ö–ª–∞—Å–∏—á–Ω—ñ —É–∫—Ä–∞—ó–Ω—Å—å–∫—ñ –ø—ñ—Å–Ω—ñ', id: 'classic_songs' },
                        { name: '–°—É—á–∞—Å–Ω–∞ —É–∫—Ä–∞—ó–Ω—Å—å–∫–∞ –º—É–∑–∏–∫–∞', id: 'modern_music' },
                        { name: '–ó–Ω–∞–∫–æ–≤—ñ —É–∫—Ä–∞—ó–Ω—Å—å–∫—ñ –∫–Ω–∏–≥–∏', id: 'iconic_books' },
                        { name: '–£–∫—Ä–∞—ó–Ω—Å—å–∫–µ –∫—ñ–Ω–æ —Ç–∞ —Ç–µ–∞—Ç—Ä', id: 'cinema_theater' },
                        { name: '–ù–∞—Ä–æ–¥–Ω—ñ –ø—ñ—Å–Ω—ñ —Ç–∞ –∫–æ–ª—è–¥–∫–∏', id: 'folk_songs' },
                        { name: '–í–∏–ø–∞–¥–∫–æ–≤–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç', id: 'content_random' }
                    ]
                }
            };
            
            const categoryData = categories[category];
            if (!categoryData) return;
            
            categoryTitle.textContent = categoryData.title;
            subcategoryGrid.innerHTML = '';
            
            categoryData.subcategories.forEach(sub => {
                const card = document.createElement('div');
                card.className = 'subcategory-card';
                card.textContent = sub.name;
                card.onclick = () => showAdvancedLesson(category, sub.id, sub.name);
                subcategoryGrid.appendChild(card);
            });
            
            categoryOptions.style.display = 'block';
            categoryOptions.scrollIntoView({ behavior: 'smooth' });
        }

        // Show advanced lesson with API call
        async function showAdvancedLesson(category, subcategory, subcategoryName) {
            const lessonContent = document.getElementById('lessonContent');
            
            if (isLoading) return;
            
            isLoading = true;
            lessonContent.innerHTML = '<div style="text-align: center; padding: 20px;">–ì–æ—Ç—É—é —ñ–Ω—Ç–µ–ª–µ–∫—Ç—É–∞–ª—å–Ω–∏–π –º–∞—Ç–µ—Ä—ñ–∞–ª...</div>';
            lessonContent.style.display = 'block';
            
            try {
                const response = await fetch('/api/advanced-lesson', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ 
                        category: category,
                        subcategory: subcategory,
                        subcategoryName: subcategoryName
                    })
                });

                const data = await response.json();
                
                if (response.ok && data.success) {
                    lessonContent.innerHTML = `<div class="reflection-text">${data.lesson}</div>`;
                    lessonContent.scrollIntoView({ behavior: 'smooth' });
                } else {
                    throw new Error(data.error || 'Failed to load advanced lesson');
                }
            } catch (error) {
                lessonContent.innerHTML = `<div class="error">–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —É—Ä–æ–∫—É: ${error.message}</div>`;
            } finally {
                isLoading = false;
            }
        }

        // Chat functionality with API call
        async function sendMessage() {
            const chatInput = document.getElementById('chatInput');
            const chatResponse = document.getElementById('chatResponse');
            const chatText = document.getElementById('chatText');
            const chatBtn = document.getElementById('chatBtn');
            
            const message = chatInput.value.trim();
            
            if (!message) {
                showError('–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è');
                return;
            }

            if (isLoading) return;
            
            isLoading = true;
            chatBtn.disabled = true;
            chatBtn.textContent = '–û–±—Ä–æ–±–∫–∞...';
            
            chatText.innerHTML = '<div style="text-align: center; padding: 20px;">–î—É–º–∞—é –Ω–∞–¥ –≤—ñ–¥–ø–æ–≤—ñ–¥–¥—é...</div>';
            chatResponse.style.display = 'block';
            
            try {
                const response = await fetch('/api/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ message: message })
                });

                const data = await response.json();
                
                if (response.ok && data.success) {
                    chatText.innerHTML = `<div class="reflection-text">${data.response}</div>`;
                    chatInput.value = '';
                    chatResponse.scrollIntoView({ behavior: 'smooth' });
                } else {
                    throw new Error(data.error || 'Failed to get chat response');
                }
            } catch (error) {
                chatText.innerHTML = `<div class="error">–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ—Ç—Ä–∏–º–∞–Ω–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ: ${error.message}</div>`;
            } finally {
                isLoading = false;
                chatBtn.disabled = false;
                chatBtn.textContent = '–ù–∞–¥—ñ—Å–ª–∞—Ç–∏';
            }
        }

        // Handle Enter key in chat
        function handleChatKeyPress(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }

        // Error display helper
        function showError(message) {
            // Create temporary error div
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error';
            errorDiv.textContent = message;
            errorDiv.style.position = 'fixed';
            errorDiv.style.top = '20px';
            errorDiv.style.right = '20px';
            errorDiv.style.zIndex = '1000';
            errorDiv.style.maxWidth = '300px';
            
            document.body.appendChild(errorDiv);
            
            // Remove after 5 seconds
            setTimeout(() => {
                if (errorDiv.parentNode) {
                    errorDiv.parentNode.removeChild(errorDiv);
                }
            }, 5000);
        }

        // Add some visual feedback
        document.querySelectorAll('.cultural-card').forEach(card => {
            card.addEventListener('click', function() {
                // Add click animation
                this.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    this.style.transform = '';
                }, 150);
            });
        });
    </script>
</body>
</html>